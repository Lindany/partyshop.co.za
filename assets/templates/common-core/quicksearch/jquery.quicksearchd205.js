!function (t) { var e = function (e, s, i) { settings = t.extend({ minimumCharacters: 3, searchDelay: 100, limitPerCategory: 5, actionFunction: null, align: "left", width: "300", showIcons: !0, showEffect: "scroll", hideEffect: "fade" }, i), this._settings = settings; e = t(e); var a = t(document.createElement("div")); a.attr("class", "searchlight-balloon"), a.css({ position: "absolute", zIndex: "1005", top: t('#searchBox input[type="text"]').outerHeight(!0), display: "none" }), "auto" == settings.width && a.css("width", e.outerWidth()), "left" == settings.align ? a.css("left", "0px") : "right" == settings.align && a.css("right", t("#searchBox").innerWidth() - (e.offset().left + e.outerWidth())); var h = t(document.createElement("div")); h.attr("class", "searchlight-results-wrapper"), h.css({ height: "100%" }), a.append(h), t("#searchBox form").append(a), this._input = e, this._container = a, this._searchURL = s, this._resultsContainer = h, e.bind("focus.searchlight", { searchlight: this }, function (t) { var e = t.data.searchlight; this.value.length >= settings.minimumCharacters && e.search(this.value) }), t("#searchBox").bind("mousedown.searchlight", { searchlight: this }, function (t) { for (var e = t.data.searchlight, s = t.target; s;) { if (s == e._input[0] || s == e._container[0]) return; s = s.parentNode } e.hide() }), e.bind("keydown.searchlight", { searchlight: this }, function (t) { var e = t.data.searchlight; 38 == t.which && e._selectedRow > 0 ? e.selectRow(e._selectedRow - 1) : 40 == t.which && e._selectedRow < e._rowCount - 1 ? e.selectRow(e._selectedRow + 1) : 13 == t.which && e._selectedRow > -1 && e.activateRow(e._selectedRow), 38 != t.which && 40 != t.which || t.preventDefault() }), e.bind("keyup.searchlight", { searchlight: this }, function (t) { var e = t.data.searchlight; e._searchDelayTimer && clearTimeout(e._searchDelayTimer), e._searchDelayTimer = setTimeout(function () { var t = e._input[0]; t.value == e._previousQuery || (t.value.length >= settings.minimumCharacters ? e.search(t.value) : e.hide()) }, settings.searchDelay) }), e.bind("keypress.searchlight", { searchlight: this }, function (t) { t.data.searchlight }), this._container.bind("mouseleave.searchlight", { searchlight: this }, function (t) { t.data.searchlight.selectRow(-1) }), this.resultAction = settings.actionFunction ? settings.actionFunction : this.defaultResultAction }; e.prototype.show = function () { this._container.is(":visible") || this._container.fadeIn("fast") }, e.prototype.hide = function () { this._disableHide || this._container.fadeOut("fast") }, e.prototype.search = function (e) { var s = this; this._previousQuery = e, this._previousXHR && this._previousXHR.abort(), this._previousXHR = t.getJSON(this._searchURL, { q: e }, function (t) { s.clearResults(); for (var e = 0; e < t.length; e++) { var i = t[e]; i.results.length > 0 && s.addResultCategory(i.title, i.results) } s.show() }) }, e.prototype.clearResults = function () { this._categoryCount = 0, this._rowCount = 0, this._selectedRow = -1, this._resultsContainer.html('<table class="searchlight-results"></table>') }, e.prototype.addResultCategory = function (e, s) { for (var i = 0; i < s.length; i++) { var a = s[i], h = document.createElement("tr"); t(h).attr("class", "searchlight-not-selected"); var n = document.createElement("td"); t(n).html('<span class="searchlight-result-text"></span>'); var r = n.firstChild; if (this._settings.showIcons) { var c = document.createElement("img"); c.className = "searchlight-result-icon", c.style.width = "50px", c.src = a[2] ? a[2] : "assets/templates/common-html5/images/spacer.gif", t(r).append(c) } t(r).append(a[1]), t(r).append("<br><span align=right class=search-price>" + a[3] + "</span>&nbsp;<img src='assets/templates/common-html5/images/star" + a[4] + ".png'>"), t(h).append(n), t(h).bind("mousemove", { searchlight: this }, function (t) { t.data.searchlight.selectRow(this._rowId) }), t(h).bind("click", { searchlight: this }, function (t) { t.data.searchlight.activateRow(this._rowId) }), h._rowId = this._rowCount, h._actionValue = a[0], this._resultsContainer.children("table").append(h), this._rowCount++ } h = document.createElement("tr"), n = document.createElement("td"); h.className = "searchlight-spacer-row", t(h).append(n), this._resultsContainer.children("table").append(h), this._categoryCount++ }, e.prototype.selectRow = function (e) { this._selectedRow = e, this._resultsContainer.find("tr:not(.searchlight-spacer-row)").each(function (s) { this._rowId == e ? t(this).hasClass("searchlight-selected") || (t(this).removeClass("searchlight-not-selected"), t(this).addClass("searchlight-selected")) : t(this).hasClass("searchlight-not-selected") || (t(this).removeClass("searchlight-selected"), t(this).addClass("searchlight-not-selected")) }) }, e.prototype.activateRow = function (t) { this.resultAction(this._resultsContainer.find("tr:not(.searchlight-spacer-row):eq(" + t + ")")[0]._actionValue) }, e.prototype.defaultResultAction = function (t) { window.location.href = t }, t.fn.searchlight = function (t, s) { this.each(function () { new e(this, t, s) }) } }(jQuery);